readハンドラについて

readの引数は、デバイスファイルのオープン時にカーネルが作成したfile構造体へのポインタ

これは、openハンドラでfile->private_dataを参照できることを意味する

buf引数は、ユーザプロセスがread()で指定したバッファへのポインタが格納されている。ユーザ空間にあるバッファへアクセスする場合には、copy_to_user()カーネル関数を使用する必要がある。

readハンドラの返り値は、バッファに書き込んだバイト数を返す

writeハンドラも同様である。